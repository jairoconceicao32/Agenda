#include "menu.nvgt"
#include "funcoes_agenda.nvgt"

sound s;

void principal() {
	s.load("sons/open.ogg");
	s.play_wait();
	wait(100);
	speak("Bem-vindo a agenda telefônica!");
	wait(200);
	Contato schema;
	bancoAgenda.execute(schema.schema);

	puxarContatos();

	while (true) {
		menu m;
		m.intro_text = "Use as cetas para navegar pelas op��es do programa e ap�s precione enter.";
		wait(500);
		m.click_sound = "sons/click.ogg";
		m.select_sound = "sons/select.ogg";
		s.load("sons/music.ogg");
		s.volume = -25;
		show_window("Agenda telefônica - versão" + agenda_ver);
		m.wrap = false;
		m.focus_first_item = true;
		m.add_item("Cadastrar contatos", "cad");
		m.add_item("Deletar contato", "del");
		m.add_item("Listar contatos cadastrados", "list");
		m.add_item("Mudanças", "changes");
		m.add_item("Verificar atualizações", "update");
		m.add_item("Sair do programa", "exit");
		s.play_looped();
		int select = m.run();
		if (select == -1) {
			wait(600);
			speak("Obrigado por utilizar nossa agenda telefônica!");
			wait(1200);
			s.load("sons/close.ogg");
			s.play_wait();
			break;
		}
		if (select >= 0) {
			string selected_id = m.get_selected_item_id();
			if (selected_id == "cad")
				addContacts();
			else if (selected_id == "list")
				listContacts();
			else if (selected_id == "del")
				deleteContacts();
			else if (selected_id == "changes")
				ler_mudancas();
			else if (selected_id == "update")
				agenda_updater();
			else {
				wait(600);
				speak("Obrigado por utilizar nossa agenda telefônica!");
				wait(1200);
				s.load("sons/close.ogg");
				s.play_wait();
				exit();
			}
		}
	}
}
